name: Multiple Daily Commits

on:
  schedule:
    # –ó–∞–ø—É—Å–∫–∏ –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –¥–Ω—è (–ú–°–ö –≤—Ä–µ–º—è)
    - cron: '0 5 * * *'  # 08:00 –ú–°–ö - —É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã
    - cron: '0 8 * * *'  # 11:00 –ú–°–ö - –¥–Ω–µ–≤–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã  
    - cron: '0 11 * * *' # 14:00 –ú–°–ö - –ø–æ—Å–ª–µ–æ–±–µ–¥–µ–Ω–Ω—ã–µ
    - cron: '0 14 * * *' # 17:00 –ú–°–ö - –≤–µ—á–µ—Ä–Ω–∏–µ
  workflow_dispatch:

jobs:
  commit-session:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0
    
    - name: Generate 3-4 commits
      run: |
        # –°–ª—É—á–∞–π–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–∏—Ç–æ–≤ –æ—Ç 3 –¥–æ 4
        COMMIT_COUNT=$((3 + RANDOM % 2))
        
        for i in $(seq 1 $COMMIT_COUNT); do
          echo "–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ $i –∏–∑ $COMMIT_COUNT..."
          
          # –°–æ–∑–¥–∞–µ–º —Ä–∞–∑–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
          FILES=("activities.json" "progress.log" "updates.md" "stats.txt")
          FILE=${FILES[$RANDOM % ${#FILES[@]}]}
          
          # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª
          echo "Update $(date -u +'%Y-%m-%d %H:%M:%S') - Commit $i" >> $FILE
          
          git config --local user.email "github-actions[bot]@users.noreply.github.com" 
          git config --local user.name "github-actions[bot]"
          
          git add $FILE
          git commit -m "üìù $(date -u +'%H:%M') - Update $FILE" --allow-empty
          
          sleep 1
        done
        
        git push
    
    - name: Send Telegram success notification
      if: success() && env.has_changes == 'true'
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        MESSAGE="‚úÖ <b>GitHub Actions - –£—Å–ø–µ—à–Ω–æ!</b>%0A%0A"
        MESSAGE+="üéØ <b>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:</b> <code>${{ github.repository }}</code>%0A"
        MESSAGE+="üìÖ <b>–í—Ä–µ–º—è:</b> $(date -u +'%Y-%m-%d %H:%M:%S UTC')%0A"
        MESSAGE+="üöÄ <b>–°—Ç–∞—Ç—É—Å:</b> –ù–æ–≤—ã–π –∫–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–ø—É—à–µ–Ω%0A"
        MESSAGE+="üë§ <b>–ó–∞–ø—É—â–µ–Ω–æ:</b> ${{ github.actor }}%0A%0A"
        MESSAGE+="<i>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞–≤—Ç–æ-–∫–æ–º–º–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω</i>"
        
        curl -s -X POST \
          "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
          -d chat_id="${TELEGRAM_CHAT_ID}" \
          -d text="${MESSAGE}" \
          -d parse_mode="HTML"
        
        echo "üì± Telegram notification sent"
    
    - name: Send Telegram no changes notification
      if: success() && env.has_changes == 'false'
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        MESSAGE="‚ÑπÔ∏è <b>GitHub Actions - –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π</b>%0A%0A"
        MESSAGE+="üéØ <b>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:</b> <code>${{ github.repository }}</code>%0A"
        MESSAGE+="üìÖ <b>–í—Ä–µ–º—è:</b> $(date -u +'%Y-%m-%d %H:%M:%S UTC')%0A"
        MESSAGE+="üí° <b>–°—Ç–∞—Ç—É—Å:</b> –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞%0A%0A"
        MESSAGE+="<i>–§–∞–π–ª—ã —É–∂–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã</i>"
        
        curl -s -X POST \
          "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
          -d chat_id="${TELEGRAM_CHAT_ID}" \
          -d text="${MESSAGE}" \
          -d parse_mode="HTML"
        
        echo "üì± Telegram no-changes notification sent"
    
    - name: Send Telegram failure notification
      if: failure()
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        MESSAGE="‚ùå <b>GitHub Actions - –û—à–∏–±–∫–∞!</b>%0A%0A"
        MESSAGE+="üéØ <b>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:</b> <code>${{ github.repository }}</code>%0A"
        MESSAGE+="üìÖ <b>–í—Ä–µ–º—è:</b> $(date -u +'%Y-%m-%d %H:%M:%S UTC')%0A"
        MESSAGE+="üö® <b>–°—Ç–∞—Ç—É—Å:</b> Workflow –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π%0A"
        MESSAGE+="üîó <b>–õ–æ–≥–∏:</b> https://github.com/${{ github.repository }}/actions%0A%0A"
        MESSAGE+="<i>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ workflow –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</i>"
        
        curl -s -X POST \
          "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
          -d chat_id="${TELEGRAM_CHAT_ID}" \
          -d text="${MESSAGE}" \
          -d parse_mode="HTML"
        
        echo "üì± Telegram failure notification sent"

    - name: Send detailed Telegram notification
      if: success() && env.has_changes == 'true'
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        MESSAGE="üöÄ <b>Git Auto-Commit –£—Å–ø–µ—à–Ω–æ!</b>%0A%0A"
        MESSAGE+="üìÖ <b>–í—Ä–µ–º—è:</b> $(date -u +'%Y-%m-%d %H:%M:%S UTC')%0A"
        MESSAGE+="üî¢ <b>–í—Å–µ–≥–æ –∫–æ–º–º–∏—Ç–æ–≤:</b> ${{ steps.commit_bot.outputs.total_commits }}%0A"
        MESSAGE+="üìä <b>–ó–∞ –Ω–µ–¥–µ–ª—é:</b> ${{ steps.commit_bot.outputs.weekly_commits }}%0A"
        MESSAGE+="üíº <b>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</b> ${{ steps.commit_bot.outputs.activity }}%0A"
        MESSAGE+="üë§ <b>–ó–∞–ø—É—â–µ–Ω–æ:</b> ${{ github.actor }}%0A%0A"
        MESSAGE+="<i>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ${{ github.repository }}</i>"
        
        curl -s -X POST \
          "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
          -d chat_id="${TELEGRAM_CHAT_ID}" \
          -d text="${MESSAGE}" \
          -d parse_mode="HTML"